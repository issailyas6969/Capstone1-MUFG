<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manufacturing Equipment Output Prediction</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 650px;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="container bg-white p-8 rounded-2xl shadow-lg border border-gray-200">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">Manufacturing Equipment Output Prediction</h1>
        <p class="text-center text-gray-500 mb-8">Enter machine and process parameters to predict production rate.</p>

        <form id="predictionForm" class="space-y-6">
            <!-- Numeric Inputs -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Injection Temperature</label>
                    <input type="number" id="Injection_Temperature" value="220.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Injection Pressure</label>
                    <input type="number" id="Injection_Pressure" value="30.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Cycle Time</label>
                    <input type="number" id="Cycle_Time" value="40.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Cooling Time</label>
                    <input type="number" id="Cooling_Time" value="14.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Material Viscosity</label>
                    <input type="number" id="Material_Viscosity" value="380.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Machine Age</label>
                    <input type="number" id="Machine_Age" value="5.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Operator Experience</label>
                    <input type="number" id="Operator_Experience" value="10.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Temp/Pressure Ratio</label>
                    <input type="number" id="Temperature_Pressure_Ratio" value="1.6" step="0.001" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Total Cycle Time</label>
                    <input type="number" id="Total_Cycle_Time" value="42.0" step="0.1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Efficiency Score</label>
                    <input type="number" id="Efficiency_Score" value="0.08" step="0.001" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                </div>
            </div>

            <!-- Dropdowns -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Shift</label>
                    <select id="Shift" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <option value="Day" selected>Day</option>
                        <option value="Evening">Evening</option>
                        <option value="Night">Night</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Machine Type</label>
                    <select id="Machine_Type" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <option value="Type_A" selected>Type A</option>
                        <option value="Type_B">Type B</option>
                        <option value="Type_C">Type C</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Material Grade</label>
                    <select id="Material_Grade" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <option value="Standard" selected>Standard</option>
                        <option value="Premium">Premium</option>
                        <option value="Economy">Economy</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Day of Week</label>
                    <select id="Day_of_Week" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <option value="Friday" selected>Friday</option>
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                    </select>
                </div>
            </div>

            <button type="submit" class="w-full bg-blue-600 text-white py-3 px-4 rounded-md font-semibold hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 transition-colors duration-200">
                Get Prediction
            </button>
        </form>

        <!-- Prediction Result Display -->
        <div id="result" class="mt-8 p-6 bg-gray-50 rounded-lg shadow-inner border border-gray-200 hidden">
            <h2 class="text-xl font-bold text-gray-800">Prediction:</h2>
            <p class="text-2xl mt-2 font-mono text-gray-900" id="predictionValue"></p>
        </div>
    </div>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            // Gather inputs
            const features = {
                Injection_Temperature: parseFloat(document.getElementById('Injection_Temperature').value),
                Injection_Pressure: parseFloat(document.getElementById('Injection_Pressure').value),
                Cycle_Time: parseFloat(document.getElementById('Cycle_Time').value),
                Cooling_Time: parseFloat(document.getElementById('Cooling_Time').value),
                Material_Viscosity: parseFloat(document.getElementById('Material_Viscosity').value),
                Machine_Age: parseFloat(document.getElementById('Machine_Age').value),
                Operator_Experience: parseFloat(document.getElementById('Operator_Experience').value),
                Temperature_Pressure_Ratio: parseFloat(document.getElementById('Temperature_Pressure_Ratio').value),
                Total_Cycle_Time: parseFloat(document.getElementById('Total_Cycle_Time').value),
                Efficiency_Score: parseFloat(document.getElementById('Efficiency_Score').value),
                Shift: document.getElementById('Shift').value,
                Machine_Type: document.getElementById('Machine_Type').value,
                Material_Grade: document.getElementById('Material_Grade').value,
                Day_of_Week: document.getElementById('Day_of_Week').value
            };

            // Validate
            if (Object.values(features).some(v => v === "" || v === null || isNaN(v) && typeof v !== "string")) {
                alert("Please fill all fields correctly.");
                return;
            }

            try {
                // Send request
                const response = await fetch("http://127.0.0.1:5000/predict", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(features)
                });

                if (response.ok) {
                    const data = await response.json();
                    document.getElementById("predictionValue").textContent = `${data.prediction.toFixed(2)} Parts Per Hour`;
                    document.getElementById("result").classList.remove("hidden");
                } else {
                    const error = await response.json();
                    alert(`Error: ${error.error}`);
                }
            } catch (error) {
                alert("Error connecting to server. Is Flask running?");
                console.error(error);
            }
        });
    </script>
</body>
</html>
